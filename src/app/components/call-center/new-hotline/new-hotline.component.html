<app-login-nav></app-login-nav>

<form [formGroup]="form" (ngSubmit)="saveAction()">
  <nav class="navbar navbar-expand-lg navbar-class">
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNav"
      aria-controls="navbarNav"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
        <ng-container *ngIf="policyData">
          <li class="nav-item">
            <label class="notification-icon">
              <img
                src="./assets/icons/mail-hover.png"
                alt=""
                [matTooltip]="dico?.dico_email || 'dico_email'"
                (click)="navigateToMail()"
              />
            </label>
          </li>
          <li class="nav-item">
            <label class="notification-icon">
              <img
                src="./assets/icons/matrix.png"
                alt=""
                class="icon"
                [matTooltip]="dico?.dico_view_policy || 'dico_view_policy'"
                (click)="viewPolicy()"
              />
              {{ dico?.dico_view_policy || "dico_view_policy" }}
            </label>
          </li>
          <li class="nav-item">
            <app-view-complaints
              [notificationId]="policyData!.notificationId"
              [label]="dico?.dico_complaints || 'dico_complaints'"
            ></app-view-complaints>
          </li>
          <li class="nav-item">
            <label>
              <app-view-notes
                [notificationId]="policyData!.notificationId"
                [label]="dico?.dico_note || 'dico_note'"
              ></app-view-notes>
            </label>
          </li>
          <li class="nav-item">
            <label class="notification-icon">
              <img
                src="./assets/icons/search-hover.png"
                alt=""
                class="icon"
                [matTooltip]="dico?.dico_tow_cases || 'dico_tow_cases'"
                (click)="openTowingDispDialog()"
              />
            </label>
          </li>
          <li class="nav-item">
            <label class="notification-icon">
              <img
                src="./assets/icons/search.png"
                alt=""
                class="icon"
                [matTooltip]="dico?.dico_claims || 'dico_claims'"
                (click)="openClaimsDialog()"
              />
            </label>
          </li>
          <li class="nav-item">
            <label>
              <app-new-notification-related
                [notificationId]="policyData.notificationId"
                [label]="
                  dico?.dico_related_notification || 'dico_related_notification'
                "
                [notificationVisa]="policyData.notificationVisa"
              ></app-new-notification-related>
            </label>
            <span class="ms-2" style="color: white; font-weight: bold">
              {{ policyData.insuranceDesc }}
            </span>
          </li>
          <li class="nav-item">
            <label>
              {{
                dico?.dico_notification_number || "dico_notification_number"
              }}:
            </label>
            <span class="ms-2" style="color: white; font-weight: bold">
              {{ policyData.notificationVisa }}
            </span>
          </li>
          <li class="nav-item">
            <button class="btn-class ms-2" type="submit">
              {{ dico?.dico_save || "dico_save" }}
            </button>
          </li>
          <li class="nav-item">
            <app-back-button
              targetRoute="/profiles-main/CallCenter/searchNotification"
              [showBackBtn]="true"
            ></app-back-button>
          </li>
        </ng-container>
      </ul>
    </div>
  </nav>
  <ng-container *ngIf="policyData">
    <div class="container-fluid container-class">
      <div class="panel row">
        <div class="col-md-3">
          <div
            class="card mb-3 h-100"
            style="background-color: #eff2f5; border-color: #bfc6c9"
          >
            <div class="card-body">
              <div class="row">
                <span class="label-color">{{
                  dico?.dico_policy_information || "dico_policy_information"
                }}</span>
              </div>
              <div class="row p-3">
                <div class="col-md-4">
                  <label>{{
                    dico?.dico_policy_number || "dico_policy_number"
                  }}</label>
                  <span>{{ form.get("policyNumber")?.value }}</span>
                </div>
                <div class="col-md-4">
                  <label>{{
                    dico?.dico_endorsment || "dico_endorsment"
                  }}</label>
                  <p>
                    {{
                      form.get("policyAmendment")?.value === 0
                        ? policyData.policyCar
                        : form.get("policyAmendment")?.value
                    }}
                  </p>
                </div>
                <!-- *ngIf="coreConfig.polserno ==='true' " -->
                <div class="col-md-4" *ngIf="polserno === 'true'">
                  <label>{{ dico?.dico_polserno || "dico_polserno" }}</label>
                  <p>{{ policyData.policyIdIns }}</p>
                </div>
              </div>
              <!-- *ngIf="coreConfig.ccBrokerValid ==='true' " -->
              <ng-container *ngIf="ccBrokerValid === 'true'">
                <div class="row p-3">
                  <div class="col-md-4">
                    <label
                      >{{ dico?.dico_broker_name || "dico_broker_name" }}
                    </label>
                    <p>{{ form.get("brokerDesc")?.value }}</p>
                  </div>
                  <div class="col-md-4">
                    <label>{{
                      dico?.dico_broker_phone || "dico_broker_phone"
                    }}</label>
                    <p>{{ policyData.brokerTelephone }}</p>
                  </div>
                </div>
              </ng-container>
              <div class="row p-3">
                <div class="col-md-4">
                  <label
                    >{{ dico?.dico_effective_date || "dico_effective_date" }}
                  </label>
                  <p>
                    {{
                      form.get("policyEffectiveDate")?.value
                        | date : dateFormat("reportDateFormat")
                    }}
                  </p>
                </div>
                <div class="col-md-4">
                  <label>{{
                    dico?.dico_expiry_date || "dico_expiry_date"
                  }}</label>
                  <p>
                    {{
                      form.get("policyExpiryDate")?.value
                        | date : dateFormat("reportDateFormat")
                    }}
                  </p>
                </div>
              </div>
              <div class="row p-3">
                <!-- *ngIf="coreConfig.policyInfoTypeShow ==='TYPE_CODE' " -->

                <div
                  class="col-md-4"
                  *ngIf="policyInfoTypeShow === 'TYPE_CODE'"
                >
                  <label
                    >{{ dico?.dico_policy_type || "dico_policy_type" }}
                  </label>
                  <p>
                    {{ form.get("productsType")?.value }} -
                    {{ form.get("productsCode")?.value }}
                  </p>
                </div>

                <!-- *ngIf="coreConfig.policyInfoTypeShow ==='TYPE' " -->
                <div class="col-md-4" *ngIf="policyInfoTypeShow === 'TYPE'">
                  <label
                    >{{ dico?.dico_policy_type || "dico_policy_type" }}
                  </label>
                  <p>{{ form.get("productsType")?.value }}</p>
                </div>
                <!-- *ngIf="coreConfig.policyInfoTypeShow ==='CODE' " -->
                <div class="col-md-4" *ngIf="policyInfoTypeShow === 'CODE'">
                  <label
                    >{{ dico?.dico_policy_type || "dico_policy_type" }}
                  </label>
                  <p>{{ form.get("productsCode")?.value }}</p>
                </div>

                <!-- *ngIf="coreConfig.ccRepFlag ==='true' " -->
                <div class="col-md-4" *ngIf="ccRepFlag === 'true'">
                  <label>{{
                    dico?.dico_car_replacement || "dico_car_replacement"
                  }}</label>
                  <p>{{ policyData.policyReplacementFlag }}</p>
                </div>
                <!-- *ngIf="coreConfig.ccTowFlag ==='true' " -->
                <div class="col-md-4" *ngIf="ccTowFlag === 'true'">
                  <label>{{
                    dico?.dico_tow_allowed || "dico_tow_allowed"
                  }}</label>
                  <p>{{ policyData.policyTowFlag }}</p>
                </div>
              </div>
              <div class="row p-3">
                <div
                  class="col-md-8 d-flex align-items-center justify-content-start"
                  *ngIf="policyData?.policyExpired === 'Y'"
                >
                  <img src="./assets/icons/warning_status.png" alt="" />
                  <label class="warning-class ms-2">{{
                    dico?.dico_policy_expired || "dico_policy_expired"
                  }}</label>
                </div>
                <div
                  class="col-md-8 d-flex align-items-center justify-content-start"
                  *ngIf="policyData?.policyDeleted === 'Y'"
                >
                  <img src="./assets/icons/warning_status.png" alt="" />
                  <label class="warning-class ms-2">{{
                    dico?.dico_policy_deleted || "dico_policy_deleted"
                  }}</label>
                </div>
                <div
                  class="col-md-8 d-flex align-items-center justify-content-start"
                  *ngIf="policyData?.policyCanceled === 'Y'"
                >
                  <img src="./assets/icons/warning_status.png" alt="" />
                  <label class="warning-class ms-2">{{
                    dico?.dico_policy_canceled || "dico_policy_canceled"
                  }}</label>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div
            class="card mb-3 h-100"
            style="background-color: #eff2f5; border-color: #bfc6c9"
          >
            <div class="card-body">
              <span class="label-color">{{
                dico?.dico_vehicle_insured_information ||
                  "dico_vehicle_insured_information"
              }}</span>
              <div class="row p-3">
                <div class="col-md-4">
                  <div class="col-md-4" *ngIf="hasPerm('ccAdmin')">
                    <img
                      [matTooltip]="
                        dico?.dico_fill_no_data || 'dico_fill_no_data'
                      "
                      matTooltipPosition="right"
                      src="./assets/icons/ellipsis.png"
                      alt=""
                      style="height: 14px; width: 14px"
                      [ngClass]="{
                        'disabled-image': shouldDisableNoData()
                      }"
                      (click)="createNoDataDialog()"
                    />
                  </div>

                  <ng-container *ngIf="hasPerm('ccAdmin')">
                    <img
                      [matTooltip]="
                        dico?.dico_change_avai_data || 'dico_change_avai_data'
                      "
                      matTooltipPosition="right"
                      src="./assets/icons/edit.png"
                      alt=""
                      style="height: 14px; width: 14px"
                      [ngClass]="{
                        'disabled-image': shouldDisableEdit()
                      }"
                      (click)="changeToAvaiDataDialog()"
                    />
                  </ng-container>
                </div>
              </div>

              <div class="row p-3">
                <div class="col-md-4">
                  <label>{{ dico?.dico_car_brand || "dico_car_brand" }}</label>
                  <p>{{ policyData.brandDescription }}</p>
                </div>
                <div class="col-md-4">
                  <label>{{
                    dico?.dico_car_trademark || "dico_car_trademark"
                  }}</label>
                  <p>{{ policyData.trademarkDescription }}</p>
                </div>
              </div>

              <div
                class="row p-3"
                *ngIf="
                  policyData?.brandId === 'ZZ' ||
                  policyData?.carTrademarkCode === 'ZZZZ'
                "
              >
                <div class="col-md-4" *ngIf="policyData?.brandId === 'ZZ'">
                  <label>{{ dico?.dico_car_brand || "dico_car_brand" }}</label>
                  <p>{{ policyData.carBrandDesc }}</p>
                </div>
                <div
                  class="col-md-4"
                  *ngIf="policyData?.carTrademarkCode === 'ZZZZ'"
                >
                  <label>{{
                    dico?.dico_car_trademark || "dico_car_trademark"
                  }}</label>
                  <p>{{ policyData.carTrademarkDesc }}</p>
                </div>
              </div>

              <div
                class="row p-3"
                *ngIf="policyData?.brandLogo || policyData?.trademarkLogo"
              >
                <div class="col-md-4">
                  <img
                    [src]="'data:image/jpeg;base64,' + policyData.brandLogo"
                    alt=""
                    style="width: 60px"
                    class="car-logo"
                  />
                </div>

                <div class="col-md-4">
                  <img
                    [src]="'data:image/jpeg;base64,' + policyData.trademarkLogo"
                    alt=""
                    style="width: 60px"
                    class="car-logo"
                  />
                </div>
              </div>
              <div class="row p-3">
                <div class="col-md-4">
                  <img src="./assets/icons/number.png" alt="" />
                  <p>{{ form.get("carPlate")?.value }}</p>
                </div>

                <div class="col-md-4">
                  <label>{{ dico?.dico_car_yom || "dico_car_yom" }}</label>
                  <p>{{ form.get("carYear")?.value }}</p>
                </div>
              </div>

              <div class="row p-3">
                <div class="col-md-4">
                  <label>{{
                    dico?.dico_client_name || "dico_client_name"
                  }}</label>
                  <p>{{ policyData.clientFullNameFromNotification }}</p>
                </div>
              </div>
              <div class="row p-2">
                <table>
                  <thead [style.position]="'static'">
                    <tr>
                      <th>{{ dico?.dico_phone || "dico_phone" }}</th>
                      <th>{{ dico?.dico_name || "dico_name" }}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      *ngFor="let contact of policyData?.carsContactsPhoneList"
                    >
                      <td>{{ contact.contactsPhoneNumber }}</td>
                      <td>{{ contact.contactsPhoneName }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div
            class="card mb-3 h-100"
            style="background-color: #eff2f5; border-color: #bfc6c9"
          >
            <div class="card-body">
              <div class="row">
                <div class="col-md-6">
                  <span class="label-color">
                    {{
                      dico?.dico_notification_information ||
                        "dico_notification_information"
                    }}
                  </span>
                </div>

                <!-- Phone Icon and Expert Contact -->
                <ng-container *ngIf="showTelIcon === 'true'">
                  <div class="col-md-1">
                    <div class="d-flex justify-content-center">
                      <img
                        src="./assets/icons/phone.png"
                        alt=""
                        [style.height]="'15px'"
                        class="me-1"
                      />
                      <a
                        [href]="
                          'tel:' + telExtension + policyData.expertMobilePhone
                        "
                        class="text-nowrap"
                        [matTooltip]="policyData.expertMobilePhone!"
                      >
                        {{ dico?.dico_expert || "dico_expert" }}
                      </a>
                    </div>
                  </div>

                  <!-- Notification Contact Phone Icon and Link -->
                  <div class="col-md-1">
                    <div class="d-flex">
                      <img
                        src="./assets/icons/phone.png"
                        alt=""
                        [style.height]="'15px'"
                        class="me-1"
                      />
                      <a
                        [matTooltip]="policyData.notificationContactPhone!"
                        [href]="
                          'tel:' +
                          telExtension +
                          policyData.notificationContactPhone
                        "
                        class="text-nowrap"
                      >
                        {{
                          dico?.dico_notification_contact_phone ||
                            "dico_notification_contact_phone"
                        }}
                      </a>
                    </div>
                  </div>
                </ng-container>
              </div>
              <div class="row p-3">
                <div class="col-md-3">
                  <label>{{ dico?.dico_loss_date || "dico_loss_date" }}</label>
                  <input
                    type="text"
                    name="lossDate"
                    id="lossDate"
                    class="form-control"
                    bsDatepicker
                    [bsConfig]="{
                      dateInputFormat: 'DD/MM/YYYY HH:mm a',
                      containerClass: 'theme-dark-blue',
                      showWeekNumbers: false
                    }"
                    formControlName="lossTowLossDate"
                  />
                </div>
                <div class="col-md-3">
                  <label>{{
                    dico?.dico_reported_date || "dico_reported_date"
                  }}</label>
                  <input
                    type="text"
                    class="form-control label-class"
                    name="fromDate"
                    id="fromDate"
                    bsDatepicker
                    [bsConfig]="{
                      dateInputFormat: 'DD/MM/YYYY HH:mm a',
                      containerClass: 'theme-dark-blue',
                      showWeekNumbers: false
                    }"
                    formControlName="notificationReportedDate"
                  />
                </div>
                <div class="col-md-3">
                  <label>{{
                    dico?.dico_reported_by || "dico_reported_by"
                  }}</label>
                  <select
                    name="reportedBy"
                    id="reportedBy"
                    class="form-select"
                    formControlName="lossTowReportedById"
                  >
                    <option
                      *ngFor="let report of reportedByData"
                      [value]="report.code"
                    >
                      {{ report.description }}
                    </option>
                  </select>
                </div>

                <div class="col-md-3">
                  <label>{{
                    dico?.dico_contact_name || "dico_contact_name"
                  }}</label>
                  <input
                    type="text"
                    name="contactName"
                    id="contactName"
                    class="form-control"
                    formControlName="notificationContactName"
                  />
                </div>
              </div>
              <div class="row p-3">
                <div class="col-md-3">
                  <label>{{
                    dico?.dico_relation_to_owner || "dico_relation_to_owner"
                  }}</label>
                  <select
                    name="relationToDriver"
                    id="relationToDriver"
                    class="form-select"
                    formControlName="lossTowDriverRelationshipId"
                  >
                    <option
                      *ngFor="let relation of relationToOwnerData"
                      [value]="relation.code"
                    >
                      {{ relation.description }}
                    </option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label>{{
                    dico?.dico_driver_name || "dico_driver_name"
                  }}</label>
                  <input
                    type="text"
                    name="driverName"
                    id="driverName"
                    class="form-control"
                    formControlName="lossTowDriverName"
                  />
                </div>
                <div class="col-md-3">
                  <label>{{
                    dico?.dico_phone_number || "dico_phone_number"
                  }}</label>
                  <input
                    type="text"
                    name="phoneNumber"
                    id="phoneNumber"
                    class="form-control"
                    formControlName="notificationContactPhone"
                  />
                </div>
                <div class="col-md-3">
                  <label>{{
                    dico?.dico_involved_vehicles || "dico_involved_vehicles"
                  }}</label>
                  <input
                    type="number"
                    name="involvedVehicles"
                    id="involvedVehicles"
                    class="form-control"
                    formControlName="lossTowNbrVehInvolved"
                  />
                </div>
              </div>
              <div class="row p-3">
                <div class="col-md-3">
                  <label>{{
                    dico?.dico_expert_source || "dico_expert_source"
                  }}</label>
                  <select
                    name="expertSource"
                    id="expertSource"
                    class="form-select"
                    formControlName="lossTowEreportedById"
                  >
                    <option
                      *ngFor="let reported of eReportedBy"
                      [value]="reported.code"
                    >
                      {{ reported.description }}
                    </option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label>{{
                    dico?.dico_notification_nature || "dico_notification_nature"
                  }}</label>
                  <select
                    name="visaNature"
                    id="visaNature"
                    class="form-select"
                    formControlName="notificationMatDamageId"
                    (change)="notificationMatDamageChange()"
                  >
                    <option
                      *ngFor="let nature of natureLov"
                      [value]="nature.code"
                    >
                      {{ nature.description }}
                    </option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label>{{
                    dico?.dico_sys_created_by || "dico_sys_created_by"
                  }}</label>
                  <input
                    type="text"
                    name="createdBy"
                    id="createdBy"
                    class="form-control"
                    formControlName="sysCreatedBy"
                  />
                </div>
              </div>
              <ng-container
                *ngIf="
                  form.get('notificationMatDamageId')?.value !== '6' &&
                  hasPerm('ccSelfSurvey')
                "
              >
                <div class="row p-3">
                  <div class="col-md-10">
                    <label>{{
                      dico?.dico_self_survey || "dico_self_survey"
                    }}</label>
                    <input
                      type="text"
                      name="selfSurvey"
                      id="selfSurvey"
                      class="form-control"
                      formControlName="carSelfSurveyUrl"
                      [readOnly]="true"
                    />
                  </div>
                </div>
              </ng-container>

              <div class="row p-3">
                <div class="col-md-4">
                  <label>{{ dico?.dico_expert || "dico_expert" }}</label>

                  <ng-select
                    name="lossTowExpertNamePreference"
                    formControlName="lossTowExpertNamePreference"
                    [virtualScroll]="true"
                    (search)="getExpertBySupplierNamePreference($event)"
                    (change)="lossTowExpertNameValueChangeListener($event)"
                  >
                    <ng-option
                      *ngFor="let suggestion of supplierExperts"
                      [value]="suggestion.supplierId"
                    >
                      {{ suggestion.supplierName }}</ng-option
                    >
                  </ng-select>
                  <!-- <input
                    type="text"
                    name="expert"
                    id="expert"
                    class="form-control"
                    formControlName="lossTowExpertNamePreference"
                  /> -->
                </div>
                <div
                  class="col-md-4"
                  *ngIf="hasPerm('ccAllowChangeRespReason')"
                >
                  <label>{{
                    dico?.dico_resp_reason || "dico_resp_reason"
                  }}</label>
                  <select
                    name="RespReasonCode"
                    id="RespReasonCode"
                    class="form-select"
                    formControlName="carRespReasonCode"
                  >
                    <option
                      *ngFor="let reason of carRespReasonCodeValues"
                      [value]="reason.code"
                    >
                      {{ reason.description }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start">
      <mat-tab
        [label]="dico?.dico_expert_dispatch || 'dico_expert_dispatch'"
        *ngIf="form.get('notificationMatDamageId')?.value !== '6'"
      >
        <div class="container-fluid container-class">
          <div class="panel row">
            <div class="col-md-4">
              <div
                class="card mb-3 h-100"
                style="background-color: #eff2f5; border-color: #bfc6c9"
              >
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-5">
                      <span class="label-color">{{
                        dico?.dico_expert_city || "dico_expert_city"
                      }}</span>
                    </div>

                    <div class="col-md-2">
                      <button
                        class="button-class"
                        type="button"
                        (click)="noExpert()"
                      >
                        No Expert
                      </button>
                    </div>
                    <div class="col-md-1" *ngIf="hasPerm('ccTemaAdmin')">
                      <img
                        [src]="'./assets/icons/expert.png'"
                        alt=""
                        [matTooltip]="
                          dico?.dico_tema_exp_disp || 'dico_tema_exp_disp'
                        "
                        [ngClass]="{
                          'disabled-image': disableIcons()
                        }"
                        (click)="appExpertDispatch()"
                      />
                    </div>
                    <div class="col-md-1">
                      <!-- <div class="col-md-1" *ngIf="hasPerm('ccExpDispatchRot')"> -->
                      <img
                        [src]="'./assets/icons/expert.png'"
                        alt=""
                        [matTooltip]="
                          dico?.dico_dispatch_expert || 'dico_dispatch_expert'
                        "
                        [ngClass]="{
                          'disabled-image': disableIcons()
                        }"
                        (click)="openDispatchExpertDialog()"
                      />
                    </div>
                    <div class="col-md-1" *ngIf="hasPerm('ccAdmin')">
                      <img
                        [src]="'./assets/icons/man_expert.png'"
                        alt=""
                        [matTooltip]="
                          dico?.dico_choose_manually || 'dico_choose_manually'
                        "
                        (click)="chooseManuallyDialog()"
                        [ngClass]="{
                          'disabled-image': DisableChooseManually()
                        }"
                      />
                    </div>
                    <div class="col-md-1" *ngIf="hasPerm('ccAdmin')">
                      <img
                        [src]="'./assets/icons/injury.png'"
                        alt=""
                        [matTooltip]="
                          dico?.dico_bodily_injury || 'dico_bodily_injury'
                        "
                        [ngClass]="{
                          'disabled-image': disableIcons()
                        }"
                        (click)="addBodilyInjuryDialog()"
                      />
                    </div>
                    <div class="col-md-1" *ngIf="hasPerm('ccAdmin')">
                      <img
                        [src]="'./assets/icons/add.png'"
                        [style.height]="'20px'"
                        alt=""
                        [matTooltip]="
                          dico?.dico_add_second_expert ||
                          'dico_add_second_expert'
                        "
                        [ngClass]="{
                          'disabled-image': disableIcons()
                        }"
                        (click)="secondExpertDialog()"
                      />
                    </div>
                  </div>
                  <div class="row p-3">
                    <div class="col-md-6">
                      <label for="" class="form-label">{{
                        dico?.dico_city || "dico_city"
                      }}</label>

                      <ng-select
                        appendTo="body"
                        name="distributionTownName"
                        formControlName="distributionTownName"
                        [virtualScroll]="true"
                        (search)="searchForTerritory($event)"
                        (change)="getTownFindById($event)"
                      >
                        <ng-option
                          *ngFor="let suggestion of territoryValues"
                          [value]="suggestion.code"
                        >
                          {{ suggestion.description }}</ng-option
                        >
                      </ng-select>
                    </div>
                    <div class="col-md-6 mt-4 p-3">
                      <input
                        type="text"
                        class="form-control"
                        formControlName="distributionTownDescription"
                      />
                    </div>
                  </div>
                  <div class="row p-2">
                    <div class="col-md-4">
                      <label class="form-label">{{
                        dico?.dico_cancel_exp || "dico_cancel_exp"
                      }}</label>
                      <select
                        name="cancelExp"
                        id="cancelExp"
                        class="form-select"
                        formControlName="distributionExpCanceledId"
                        (change)="onCancelExpReasonChange()"
                      >
                        <option
                          *ngFor="let exp of ExpCancelReas"
                          [value]="exp.code"
                        >
                          {{ exp.description }}
                        </option>
                      </select>
                    </div>
                    <div class="col-md-4 p-3 mt-3">
                      <input
                        type="text"
                        class="form-control"
                        formControlName="distributionExpCanceledUserName"
                      />
                    </div>
                    <div class="col-md-4 p-3 mt-3">
                      <input
                        type="text"
                        class="form-control"
                        formControlName="distributionExpCanceledDate"
                      />
                    </div>
                  </div>
                  <div class="row p-3">
                    <div class="col-md-5">
                      <input
                        type="text"
                        class="form-control"
                        formControlName="distributionExpExpertDesc"
                        id="distributionExpExpertDesc"
                        name="distributionExpExpertDesc"
                      />
                    </div>
                  </div>
                  <div class="row p-2">
                    <div
                      class="col-md-8 d-flex align-items-center justify-content-start"
                    >
                      <label class="me-3 text-nowrap">{{
                        dico?.dico_second_expert || "dico_second_expert"
                      }}</label>
                      <!-- <label>{{ dico?.dico_expert || "dico_expert" }} : </label> -->
                      <input
                        type="text"
                        class="form-control"
                        formControlName="lossTow2ndExpertName"
                      />
                    </div>

                    <!-- <p class="mt-3">{{ policyData?.expertName }}</p> -->
                  </div>

                  <div class="row p-3">
                    <div
                      class="col-md-3"
                      *ngIf="
                        policyData?.lossTowExpertMan === 'Y' &&
                        ccRotationManual === 'true'
                      "
                    >
                      <span class="mt-3">{{
                        form.get("distributionTema")?.value === "Y"
                          ? ""
                          : form.get("lossTowExpertRot")?.value === "Y"
                          ? "In Rotation"
                          : "Out Of Rotation"
                      }}</span>
                    </div>

                    <div class="col-md-2">
                      <span class="mt-3">{{
                        form.get("distributionTema")?.value === "Y"
                          ? "TEMA Dispatch"
                          : ""
                      }}</span>
                    </div>
                    <div
                      class="col-md-2"
                      *ngIf="policyData?.distributionTema === 'Y'"
                    >
                      <span class="mt-3">{{
                        policyData.distributionTemaUser
                      }}</span>
                    </div>
                    <div
                      class="col-md-4"
                      *ngIf="policyData?.distributionTema === 'Y'"
                    >
                      <span class="mt-3">{{
                        policyData.distributionTemaDate
                          | date : dateFormat("reportDateTimeFormat")
                      }}</span>
                    </div>
                    <div
                      class="col-md-2"
                      *ngIf="policyData?.distributionTema === 'Y'"
                    >
                      <label>{{
                        dico?.dico_distributionPdfExist || "dico_tema_pdf_exist"
                      }}</label>

                      <input
                        type="checkbox"
                        name="distributionPdfExist"
                        id="distributionPdfExist"
                        [value]="
                          policyData.distributionPdfExist === 'Y' ? true : false
                        "
                        disabled
                      />
                    </div>
                  </div>
                  <div
                    class="col-md-12 d-flex text-align-end justify-content-end"
                  >
                    <img
                      src="./assets/icons/loop.png"
                      alt=""
                      [matTooltip]="
                        dico?.dico_customer_satisfaction ||
                        'dico_customer_satisfaction'
                      "
                      matTooltipPosition="right"
                      (click)="customerSatisfactionDialog('ED')"
                      style="width: 15px; height: 15px"
                    />
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div
                class="card mb-3 h-100"
                style="background-color: #eff2f5; border-color: #bfc6c9"
              >
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-4">
                      <span class="label-color">{{
                        dico?.dico_disp_date || "dico_disp_date"
                      }}</span>
                    </div>
                  </div>
                  <div class="row mt-3">
                    <div class="col-md-3 d-flex align-items-center">
                      <label class="me-3 form-check-label">{{
                        dico?.dico_dispatch || "dico_dispatch"
                      }}</label>
                      <input
                        type="checkbox"
                        class="form-check-input"
                        formControlName="distributionLossDistributionBoolean"
                      />
                    </div>
                    <div class="col-md-4">
                      <input
                        type="text"
                        name="lossDistDate"
                        id="lossDistDate"
                        class="form-control"
                        bsDatepicker
                        [bsConfig]="{
                          dateInputFormat: 'DD/MM/YYYY HH:mm a',
                          containerClass: 'theme-dark-blue',
                          showWeekNumbers: false
                        }"
                        formControlName="distributionLossDistDate"
                      />
                    </div>
                    <div class="col-md-4">
                      <input
                        type="text"
                        name="distributionLossDistUserName"
                        id="distributionLossDistUserName"
                        class="form-control"
                        formControlName="distributionLossDistUserName"
                      />
                    </div>
                  </div>

                  <div class="row mt-5">
                    <div class="col-md-3 d-flex align-items-center">
                      <label class="me-4 form-check-label">{{
                        dico?.dico_arrived || "dico_arrived"
                      }}</label>
                      <ng-container *ngIf="hasPerm('ccAdmin')">
                        <input
                          type="checkbox"
                          class="form-check-input"
                          formControlName="distributionLossArrivedBoolean"
                          (change)="onDistributionTowArived()"
                        />
                      </ng-container>
                    </div>
                    <div class="col-md-4">
                      <input
                        type="text"
                        name="distributionLossArrivedDate"
                        id="distributionLossArrivedDate"
                        class="form-control"
                        bsDatepicker
                        [bsConfig]="{
                          dateInputFormat: 'DD/MM/YYYY HH:mm a',
                          containerClass: 'theme-dark-blue',
                          showWeekNumbers: false
                        }"
                        formControlName="distributionLossArrivedDate"
                      />
                    </div>
                    <div class="col-md-4">
                      <input
                        type="text"
                        name="distributionLossArrivedUserName"
                        id="distributionLossArrivedUserName"
                        class="form-control"
                        formControlName="distributionLossArrivedUserName"
                      />
                    </div>
                    <div class="row mt-5">
                      <div class="col-md-8 d-flex align-items-center">
                        <label class="text-nowrap me-5">{{
                          dico?.dico_delayed_dispatch_time ||
                            "dico_delayed_dispatch_time"
                        }}</label>
                        <input
                          type="text"
                          class="form-control"
                          formControlName="delayedDispatchTime"
                        />
                      </div>
                    </div>
                    <div class="row mt-5">
                      <div class="col-md-5">
                        <select
                          name="distributionExpTypeId"
                          id="distributionExpTypeId"
                          class="form-select"
                          formControlName="distributionExpTypeId"
                        >
                          <option
                            *ngFor="let expert of expertDispatchType"
                            [value]="expert.code"
                          >
                            {{ expert.description }}
                          </option>
                        </select>
                      </div>
                      <div class="col-md-5">
                        <input
                          type="text"
                          name="expertMobilePhone"
                          id="expertMobilePhone"
                          class="form-control"
                          formControlName="expertMobilePhone"
                        />
                      </div>
                    </div>
                    <div class="row mt-4">
                      <div class="col-md-5">
                        <input
                          type="text"
                          name="distributionExpExpertDesc"
                          id="distributionExpExpertDesc"
                          class="form-control"
                          formControlName="distributionExpExpertDesc"
                        />
                      </div>
                      <div class="col-md-5">
                        <input
                          type="text"
                          name="distributionExpTypeDate"
                          id="distributionExpTypeDate"
                          class="form-control"
                          bsDatepicker
                          [bsConfig]="{
                            dateInputFormat: 'DD/MM/YYYY HH:mm a',
                            containerClass: 'theme-dark-blue',
                            showWeekNumbers: false
                          }"
                          formControlName="distributionExpTypeDate"
                          readonly
                        />
                      </div>
                    </div>
                    <div class="row mt-4">
                      <div class="col-md-5">
                        <input
                          type="text"
                          name="distributionExpTypeUserName"
                          id="distributionExpTypeUserName"
                          class="form-control"
                          formControlName="distributionExpTypeUserName"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div
                class="card mb-3 h-100"
                style="background-color: #eff2f5; border-color: #bfc6c9"
              >
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-4">
                      <span class="label-color">{{
                        dico?.dico_disp_problem || "dico_disp_problem"
                      }}</span>
                    </div>
                  </div>
                  <div class="table-responsive p-2">
                    <table>
                      <thead [style.position]="'static'">
                        <tr>
                          <th>{{ dico?.dico_expert || "dico_expert" }}</th>
                          <th>
                            {{
                              dico?.dico_unavailable_reason ||
                                "dico_unavailable_reason"
                            }}
                          </th>
                          <th>{{ dico?.dico_date || "dico_date" }}</th>
                          <th>{{ dico?.dico_note || "dico_note" }}</th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody
                        *ngIf="
                          policyData?.expertUnavailableList.length > 0;
                          else noData
                        "
                      >
                        <tr
                          *ngFor="
                            let expertUnAvailable of policyData?.expertUnavailableList;
                            let i = index
                          "
                          [ngClass]="{ 'selected-row': i === selectedRowIndex }"
                          (click)="selectRowExpert(i)"
                        >
                          <td>{{ expertUnAvailable.supplierName }}</td>
                          <td>
                            {{
                              expertUnAvailable.expertUnavReasonId.description
                            }}
                          </td>
                          <td>
                            {{
                              expertUnAvailable.expertUnavTime
                                | date : dateFormat("reportDateTimeFormat")
                            }}
                          </td>
                          <td>{{ expertUnAvailable.expertUnavRemarks }}</td>
                          <td *ngIf="hasPerm('ccAdmin')">
                            <mat-icon
                              [ngClass]="{
                                'disabled-image': disableDeleteExpertUnAvai()
                              }"
                              (click)="
                                deleteExpertUnavailable(
                                  expertUnAvailable.expertUnavId
                                )
                              "
                              >delete</mat-icon
                            >
                          </td>
                        </tr>
                      </tbody>
                      <ng-template #noData>
                        <tr>
                          <td colspan="8">
                            {{
                              dico?.BASIC_NO_DATA_TO_DISPLAY ||
                                "BASIC_NO_DATA_TO_DISPLAY"
                            }}
                          </td>
                        </tr>
                      </ng-template>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>
      <mat-tab
        [label]="dico?.dico_towing_dispatch || 'dico_towing_dispatch'"
        *ngIf="dispatchTowingShow()"
      >
        <div
          class="container-fluid container-class"
          *ngIf="dispatchTowingShow()"
        >
          <div class="panel row">
            <div class="col-md-12">
              <div class="grid-container">
                <div class="row">
                  <div class="col-md-3">
                    <h3>
                      {{ dico?.dico_towing_dispatch || "dico_towing_dispatch" }}
                    </h3>
                  </div>
                  <div
                    class="col-md-2"
                    *ngIf="shouldShowDistributionTowNatureLink()"
                  >
                    <a
                      class="label-link"
                      [ngClass]="{
                        'disable-link': isSuggestLinkDisabled()
                      }"
                      (click)="openSuggestDialog()"
                    >
                      <img src="./assets/icons/cell.png" alt="" />
                      {{
                        dico?.dico_suggest_towing_company ||
                          "dico_suggest_towing_company"
                      }}
                    </a>
                  </div>
                  <ng-template #suggestTowCompany>
                    <div class="grid-container panel-class-style">
                      <h2 class="h5">
                        {{
                          dico?.dico_suggest_towing_company ||
                            "dico_suggest_towing_company"
                        }}
                      </h2>
                    </div>
                    <div class="container p-3">
                      <div class="panel row">
                        <table>
                          <thead [style.position]="'static'">
                            <tr>
                              <th>{{ dico?.dico_name || "dico_name" }}</th>
                              <th *ngIf="showTelIcon === 'true'"></th>
                              <th *ngIf="policyData?.towingCompanyList">
                                {{ dico?.dico_bus_phone || "dico_bus_phone" }}
                              </th>
                              <th *ngIf="showTelIcon === 'true'"></th>
                              <th *ngIf="policyData?.towingCompanyList">
                                {{
                                  dico?.dico_mobile_phone || "dico_mobile_phone"
                                }}
                              </th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr
                              *ngFor="
                                let towingCmp of policyData?.towingCompanyList;
                                let i = index
                              "
                              [ngClass]="{
                                'selected-row': i === selectedRowIndex
                              }"
                              (click)="selectRowTowingCompany(i, towingCmp)"
                            >
                              <td *ngIf="towingCmp != null">
                                {{ towingCmp?.name }}
                              </td>
                              <td
                                *ngIf="
                                  showTelIcon === 'true' &&
                                  towingCmp?.supplierBusPhone
                                "
                              >
                                <a
                                  class="label-link"
                                  [href]="
                                    'tel:' +
                                    telExtension +
                                    towingCmp.supplierBusPhone
                                  "
                                >
                                  <img
                                    *ngIf="showTelIcon === 'true'"
                                    src="./assets/icons/phone.png"
                                    alt=""
                                    style="height: 15px; width: 15px"
                                /></a>
                              </td>
                              <td *ngIf="towingCmp !== null">
                                {{ towingCmp?.supplierBusPhone }}
                              </td>
                              <td
                                *ngIf="
                                  showTelIcon === 'true' &&
                                  towingCmp?.supplierMobilePhone
                                "
                              >
                                <a
                                  [href]="
                                    'tel:' +
                                    telExtension +
                                    towingCmp.supplierMobilePhone
                                  "
                                >
                                  <img
                                    *ngIf="showTelIcon === 'true'"
                                    src="./assets/icons/phone.png"
                                    style="height: 15px; width: 15px"
                                    alt=""
                                  />
                                </a>
                              </td>
                              <td *ngIf="towingCmp !== null">
                                {{ towingCmp?.supplierMobilePhone }}
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>

                    <div class="container">
                      <div class="row">
                        <div class="col-md-10">
                          <ul>
                            <li
                              class="warning-class"
                              *ngIf="
                                selectedTowingCmp?.towingConditionList[0]
                                  ?.towingConditionBlocked?.code === 'N' &&
                                form.get('lossTowBlockedId')?.value === 'Y'
                              "
                            >
                              {{
                                dico?.dico_towing_not_allowed_blocked ||
                                  "dico_towing_not_allowed_blocked"
                              }}
                            </li>
                            <li
                              class="warning-class"
                              *ngIf="
                                selectedTowingCmp?.towingConditionList[0]
                                  ?.towingConditionWheel?.code === 'N' &&
                                form.get('lossTowWheelId')?.value === 'Y'
                              "
                            >
                              {{
                                dico?.dico_towing_not_allowed_wheel ||
                                  "dico_towing_not_allowed_wheel"
                              }}
                            </li>

                            <li
                              class="warning-class"
                              *ngIf="
                                selectedTowingCmp?.towingConditionList[0]
                                  ?.towingConditionPickUp?.code === 'N' &&
                                form.get('lossTowPickUpId')?.value === 'Y'
                              "
                            >
                              {{
                                dico?.dico_towing_not_allowed_pick_up ||
                                  "dico_towing_not_allowed_pick_up"
                              }}
                            </li>
                            <li
                              class="warning-class"
                              *ngIf="
                                selectedTowingCmp?.towingConditionList[0]
                                  ?.towingConditionOffRoad?.code === 'N' &&
                                form.get('lossTowOffRoadId')?.value === 'Y'
                              "
                            >
                              {{
                                dico?.dico_towing_not_allowed_offroad ||
                                  "dico_towing_not_allowed_offroad"
                              }}
                            </li>
                            <li
                              class="warning-class"
                              *ngIf="
                                selectedTowingCmp?.towingConditionList[0]
                                  ?.towingConditionCarryingGood?.code === 'N' &&
                                form.get('lossTowCarryingGoodId')?.value === 'Y'
                              "
                            >
                              {{
                                dico?.dico_towing_not_allowed_carrygood ||
                                  "dico_towing_not_allowed_carrygood"
                              }}
                            </li>
                            <li
                              class="warning-class"
                              *ngIf="
                                selectedTowingCmp?.towingConditionList[0]
                                  ?.towingConditionLifterAcc?.code === 'N' &&
                                form.get('lossTowLifterId')?.value === 'Y' &&
                                form.get('distributionTowNatureId')?.value !=
                                  null &&
                                form.get('distributionTowNatureId')?.value ===
                                  '1'
                              "
                            >
                              {{
                                dico?.dico_towing_not_allowed_lifter ||
                                  "dico_towing_not_allowed_lifter"
                              }}
                            </li>
                            <li
                              class="warning-class"
                              *ngIf="
                                selectedTowingCmp?.towingConditionList[0]
                                  ?.towingConditionLifterMech?.code === 'N' &&
                                form.get('lossTowLifterId')?.value === 'Y' &&
                                form.get('distributionTowNatureId')?.value !==
                                  '1'
                              "
                            >
                              {{
                                dico?.dico_towing_not_allowed_lifter ||
                                  "dico_towing_not_allowed_lifter"
                              }}
                            </li>
                          </ul>
                        </div>
                      </div>
                      <div class="row" *ngIf="towingAlertRen === 'Y'">
                        <div class="col-md-10">
                          <label class="warning-class">{{
                            dico?.dico_no_more_towing_mechanical ||
                              "dico_no_more_towing_mechanical"
                          }}</label>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-10">
                          <ul>
                            <li *ngFor="let towing of policyData?.towingList">
                              {{ towing }}
                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>

                    <div class="container p-3">
                      <div class="panel row p-3">
                        <div class="col-md-6">
                          <div
                            class="d-flex justify-content-start align-items-center"
                          >
                            <label class="me-3">{{
                              dico?.dico_cover_code || "dico_cover_code"
                            }}</label>

                            <span>{{ coverByCar?.code }}</span>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div
                            class="d-flex justify-content-start align-items-center"
                          >
                            <label class="me-3">{{
                              dico?.dico_cover_description ||
                                "dico_cover_description"
                            }}</label>

                            <span>{{ coverByCar?.description }}</span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="container mt-5">
                      <div class="row p-3">
                        <div class="col">
                          <div
                            class="d-flex justify-content-end align-items-center"
                          >
                            <button
                              class="button-class me-2"
                              type="button"
                              (click)="saveSuggestTowingCmp()"
                            >
                              {{ dico?.dico_save || "dico_save" }}
                            </button>
                            <button
                              class="button-class"
                              type="button"
                              (click)="cancel()"
                            >
                              {{ dico?.dico_cancel || "dico_cancel" }}
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-template>

                  <!-- <ng-template #towConditions>
                    <div class="grid-container panel-class-style">
                      <h2 class="h5">
                        {{ dico?.dico_conditions || "dico_conditions" }}
                      </h2>
                    </div>
                    <div class="grid-container m-3">
                      <div class="row mb-2">
                        <div class="col-md-2">
                          <label class="label-form">{{
                            dico?.dico_lifter || "dico_lifter"
                          }}</label>
                        </div>
                        <div class="col-md-2">
                          <label class="label-form">{{
                            dico?.dico_blocked || "dico_blocked"
                          }}</label>
                        </div>
                        <div class="col-md-2">
                          <label class="label-form">{{
                            dico?.dico_off_road || "dico_off_road"
                          }}</label>
                        </div>
                        <div class="col-md-2">
                          <label class="label-form">{{
                            dico?.dico_pick_up || "dico_pick_up"
                          }}</label>
                        </div>
                        <div class="col-md-2">
                          <label class="label-form">{{
                            dico?.dico_wheel || "dico_wheel"
                          }}</label>
                        </div>
                        <div class="col-md-2">
                          <label class="label-form">{{
                            dico?.dico_carrying_goods || "dico_carrying_goods"
                          }}</label>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-2">
                          <div class="form-check" *ngFor="let domain of domainYn">
                            <input
                              type="radio"
                              id="lossTowLifterId"
                              class="custom-control-input"
                              name="lossTowLifterId"
                              [value]="domain.code"
                              formControlName="lossTowLifterId"
                            />
                            <label class="ms-2" for="lossTowLifterId">{{
                              domain.description
                            }}</label>
                          </div>
                        </div>
                        <div class="col-md-2">
                          <div class="form-check" *ngFor="let domain of domainYn">
                            <input
                              type="radio"
                              id="lossTowBlockedId"
                              class="custom-control-input"
                              name="lossTowBlockedId"
                              [value]="domain.code"
                              formControlName="lossTowBlockedId"
                            />
                            <label class="ms-2" for="lossTowBlockedId">{{
                              domain.description
                            }}</label>
                          </div>
                        </div>
                        <div class="col-md-2">
                          <div class="form-check" *ngFor="let domain of domainYn">
                            <input
                              type="radio"
                              id="lossTowOffRoadId"
                              class="custom-control-input"
                              name="lossTowOffRoadId"
                              [value]="domain.code"
                              formControlName="lossTowOffRoadId"
                            />
                            <label class="ms-2" for="lossTowOffRoadId">{{
                              domain.description
                            }}</label>
                          </div>
                        </div>
                        <div class="col-md-2">
                          <div class="form-check" *ngFor="let domain of domainYn">
                            <input
                              type="radio"
                              id="lossTowPickUpId"
                              class="custom-control-input"
                              name="lossTowPickUpId"
                              [value]="domain.code"
                              formControlName="lossTowPickUpId"
                            />
                            <label class="ms-2" for="lossTowPickUpId">{{
                              domain.description
                            }}</label>
                          </div>
                        </div>
                        <div class="col-md-2">
                          <div class="form-check" *ngFor="let domain of domainYn">
                            <input
                              type="radio"
                              id="lossTowWheelId"
                              class="custom-control-input"
                              name="lossTowWheelId"
                              [value]="domain.code"
                              formControlName="lossTowWheelId"
                            />
                            <label class="ms-2" for="lossTowWheelId">{{
                              domain.description
                            }}</label>
                          </div>
                        </div>
                        <div class="col-md-2">
                          <div class="form-check" *ngFor="let domain of domainYn">
                            <input
                              type="radio"
                              id="lossTowCarryingGoodId"
                              class="custom-control-input"
                              name="lossTowCarryingGoodId"
                              [value]="domain.code"
                              formControlName="lossTowCarryingGoodId"
                            />
                            <label class="ms-2" for="lossTowCarryingGoodId">{{
                              domain.description
                            }}</label>
                          </div>
                        </div>
                      </div>
                    </div>
  
                    <div class="container mt-3">
                      <div class="row p-3">
                        <div class="col">
                          <div
                            class="d-flex justify-content-end align-items-center"
                          >
                            <button
                              class="button-class me-2"
                              type="button"
                              (click)="cancel()"
                            >
                              OK
                            </button>
                            <button
                              class="button-class"
                              type="button"
                              (click)="cancel()"
                            >
                              {{ dico?.dico_cancel || "dico_cancel" }}
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-template> -->

                  <div class="col-md-2" *ngIf="hasPerm('ccAdmin')">
                    <a
                      class="label-link"
                      [ngClass]="{
                        'disable-link': isSuggestLinkDisabled()
                      }"
                      (click)="openTowConditions()"
                    >
                      <img src="./assets/icons/cell.png" alt="" />
                      {{
                        dico?.dico_modify_conditions || "dico_modify_conditions"
                      }}
                    </a>
                  </div>
                  <div class="col-md-2">
                    <a class="label-link" (click)="openTowingConditionList()">
                      <img src="./assets/icons/cell.png" alt="" />
                      {{
                        dico?.dico_general_conditions ||
                          "dico_general_conditions"
                      }}
                    </a>
                  </div>
                  <div class="col-md-2" *ngIf="hasPerm('ccAdmin')">
                    <a
                      class="label-link"
                      [ngClass]="{
                        'disable-link': isSuggestLinkDisabled()
                      }"
                      (click)="customerSatisfactionDialog('TD')"
                    >
                      <img src="./assets/icons/cell.png" alt="" />
                      {{
                        dico?.dico_customer_satisfaction ||
                          "dico_customer_satisfaction"
                      }}
                    </a>
                  </div>
                </div>

                <div class="row p-3 mt-3">
                  <div class="col-md-3">
                    <div
                      class="card h-100"
                      style="background-color: #eff2f5; border-color: #bfc6c9"
                    >
                      <div class="card-body">
                        <div class="row">
                          <div
                            class="d-flex justify-content-center align-items-center"
                          >
                            <div class="col-md-4">
                              <a
                                [href]="
                                  'tel:' +
                                  telExtension +
                                  policyData.expertMobilePhone
                                "
                                class="label-link"
                              >
                                <img src="./assets/icons/phone.png" alt="" />
                                {{ dico?.dico_towing || "dico_towing" }}
                              </a>
                            </div>
                            <div class="col-md-2" *ngIf="hasPerm('ccAdmin')">
                              <img
                                [matTooltip]="
                                  dico?.dico_add_repair_shop ||
                                  'dico_add_repair_shop'
                                "
                                [ngClass]="{
                                  'disable-link': showRepairShop()
                                }"
                                style="height: 20px; width: 20px"
                                src="./assets/icons/add.png"
                                alt=""
                                (click)="openRepairShopeDialog()"
                              />
                            </div>
                          </div>
                        </div>

                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="form-label">
                              {{ dico?.dico_nature || "dico_nature" }}</label
                            >
                            <select
                              name="towNature"
                              id="towNature"
                              class="form-select"
                              formControlName="distributionTowNatureId"
                            >
                              <option
                                *ngFor="let tow of towNatureLov"
                                [value]="tow.code"
                              >
                                {{ tow.description }}
                              </option>
                            </select>
                          </div>
                        </div>

                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="form-label">
                              {{ dico?.dico_nature || "dico_nature" }}</label
                            >
                            <input
                              type="text"
                              class="form-control"
                              formControlName="towingComDesc"
                            />
                          </div>
                        </div>
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="form-label">{{
                              dico?.dico_repair_shop || "dico_repair_shop"
                            }}</label>
                            <input
                              type="text"
                              class="form-control"
                              formControlName="lossTowRsDesc"
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div
                      class="card h-100"
                      style="background-color: #eff2f5; border-color: #bfc6c9"
                    >
                      <div class="card-body">
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="form-label">{{
                              dico?.dico_from_city || "dico_from_city"
                            }}</label>
                            <ng-select
                              appendTo="body"
                              name="fromTowTownName"
                              formControlName="fromTowTownName"
                              [virtualScroll]="true"
                              (search)="searchForTerritory($event)"
                              (change)="getTowFromTownDescription($event)"
                            >
                              <ng-option
                                *ngFor="let suggestion of territoryValues"
                                [value]="suggestion.code"
                              >
                                {{ suggestion.description }}</ng-option
                              >
                            </ng-select>
                          </div>
                          <div class="col-md-6 p-4 mt-2">
                            <input
                              type="text"
                              name="towFromTownDescription"
                              id="towFromTownDescription"
                              class="form-control"
                              formControlName="towFromTownDescription"
                            />
                          </div>
                        </div>
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="form-label">{{
                              dico?.dico_to_city || "dico_to_city"
                            }}</label>

                            <ng-select
                              appendTo="body"
                              name="towToTownName"
                              formControlName="towToTownName"
                              [virtualScroll]="true"
                              (search)="searchForTerritory($event)"
                              (change)="getTowToTownDescription($event)"
                            >
                              <ng-option
                                *ngFor="let suggestion of territoryValues"
                                [value]="suggestion.code"
                              >
                                {{ suggestion.description }}</ng-option
                              >
                            </ng-select>
                          </div>
                          <div class="col-md-6 p-4 mt-2">
                            <input
                              type="text"
                              name="towToTownDescription"
                              id="towToTownDescription"
                              class="form-control"
                              formControlName="towToTownDescription"
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div
                      class="card h-100"
                      style="background-color: #eff2f5; border-color: #bfc6c9"
                    >
                      <div class="card-body">
                        <div class="row p-4">
                          <div class="col-md-8 d-flex align-items-center">
                            <label class="me-5 form-check-label">{{
                              dico?.dico_dispatch || "dico_dispatch"
                            }}</label>
                            <input
                              type="checkbox"
                              class="form-check-input"
                              formControlName="distributionTowDistDateBoolean"
                            />
                          </div>
                        </div>
                        <div class="row p-4">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_distribution_tow_dist_date ||
                                "dico_distribution_tow_dist_date"
                            }}</label>
                            <input
                              type="text"
                              name="distributionTowDistDate"
                              id="distributionTowDistDate"
                              class="form-control"
                              bsDatepicker
                              [bsConfig]="{
                                dateInputFormat: 'DD/MM/YYYY HH:mm A',
                                containerClass: 'theme-dark-blue',
                                showWeekNumbers: false
                              }"
                              formControlName="distributionTowDistDate"
                            />
                          </div>
                        </div>
                        <div class="row p-4">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_sys_created_by || "dico_sys_created_by"
                            }}</label>
                            <input
                              type="text"
                              class="form-control"
                              formControlName="distributionTowDistUserName"
                            />
                          </div>
                        </div>
                        <div class="row p-4" *ngIf="hasPerm('ccAdmin')">
                          <div class="col-md-8 d-flex align-items-center">
                            <label class="me-5 form-check-label">{{
                              dico?.dico_arrived || "dico_arrived"
                            }}</label>
                            <input
                              type="checkbox"
                              class="form-check-input"
                              formControlName="distributionTowArrivedDateBoolean"
                              (change)="dispatchFuArrivedTowingChangeListener()"
                            />
                          </div>
                        </div>
                        <div class="row p-4">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_dist_tow_arri_date ||
                                "dico_dist_tow_arri_date"
                            }}</label>
                            <input
                              type="text"
                              name="distributionTowArrivedDate"
                              id="distributionTowArrivedDate"
                              class="form-control"
                              bsDatepicker
                              [bsConfig]="{
                                dateInputFormat: 'DD/MM/YYYY HH:mm A',
                                containerClass: 'theme-dark-blue',
                                showWeekNumbers: false
                              }"
                              formControlName="distributionTowArrivedDate"
                            />
                          </div>
                        </div>
                        <div class="row p-4">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_sys_created_by || "dico_sys_created_by"
                            }}</label>
                            <input
                              type="text"
                              class="form-control"
                              formControlName="distributionTowArrivedUserName"
                            />
                          </div>
                        </div>
                        <div class="row p-4">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_delayed_towing_time ||
                                "dico_delayed_towing_time"
                            }}</label>
                            <input
                              type="text"
                              class="form-control"
                              formControlName="delayedTowingTime"
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3">
                    <div
                      class="card h-100"
                      style="background-color: #eff2f5; border-color: #bfc6c9"
                    >
                      <div class="card-body">
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_driver_name || "dico_driver_name"
                            }}</label>
                            <input
                              type="text"
                              class="form-control"
                              formControlName="distributionTowDriverName"
                            />
                          </div>
                        </div>
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_driver_phone || "dico_driver_phone"
                            }}</label>
                            <input
                              type="text"
                              class="form-control"
                              formControlName="distributionTowDriverPhone"
                            />
                          </div>
                        </div>
                        <div class="row p-3">
                          <div class="col-md-8 d-flex align-items-center">
                            <label class="me-5 form-label">{{
                              dico?.dico_lifter || "dico_lifter"
                            }}</label>
                            <div
                              class="form-check"
                              *ngFor="let domain of domainYn"
                            >
                              <input
                                type="radio"
                                id="distributionTowDistLifterId"
                                class="custom-control-input"
                                name="distributionTowDistLifterId"
                                [value]="domain.code"
                                formControlName="distributionTowDistLifterId"
                              />
                              <label
                                class="ms-2"
                                for="distributionTowDistLifterId"
                                >{{ domain.description }}</label
                              >
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3 mt-3">
                    <div
                      class="card h-100"
                      style="background-color: #eff2f5; border-color: #bfc6c9"
                    >
                      <div class="card-body">
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_cancel_tow || "dico_cancel_tow"
                            }}</label>
                            <select
                              name="towCancelReason"
                              id="towCancelReason"
                              formControlName="distributionTowCanceledId"
                              class="form-select"
                            >
                              <option
                                *ngFor="let tow of towCancelReason"
                                [value]="tow.code"
                              >
                                {{ tow.description }}
                              </option>
                            </select>
                          </div>
                        </div>
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_delay_reason || "dico_delay_reason"
                            }}</label>
                            <select
                              name="distributionTowDelayId"
                              id="distributionTowDelayId"
                              formControlName="distributionTowDelayId"
                              class="form-select"
                            >
                              <option
                                *ngFor="let tow of towDelayReasonLov"
                                [value]="tow.code"
                              >
                                {{ tow.description }}
                              </option>
                            </select>
                          </div>
                        </div>
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_note || "dico_note"
                            }}</label>

                            <textarea
                              name="note"
                              id="note"
                              cols="30"
                              rows="5"
                              class="form-control"
                              formControlName="distributionTowDelayOther"
                            ></textarea>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3 mt-3">
                    <div
                      class="card h-100"
                      style="background-color: #eff2f5; border-color: #bfc6c9"
                    >
                      <div class="card-body">
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_total_km || "dico_total_km"
                            }}</label>
                            <input
                              type="text"
                              class="form-control"
                              formControlName="distributionTowTotalKm"
                            />
                          </div>
                        </div>
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_client_cost || "dico_client_cost"
                            }}</label>
                            <input
                              type="text"
                              class="form-control"
                              formControlName="distributionTowClientCost"
                            />
                          </div>
                        </div>
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_extra_km || "dico_extra_km"
                            }}</label>
                            <input
                              type="text"
                              class="form-control"
                              formControlName="distributionTowExtraKm"
                            />
                          </div>
                        </div>
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_total_cost || "dico_total_cost"
                            }}</label>
                            <input
                              type="number"
                              class="form-control"
                              formControlName="distributionTowTotalCost"
                            />
                          </div>
                        </div>
                        <div class="row p-3">
                          <div class="col-md-8">
                            <label class="me-5 form-label">{{
                              dico?.dico_total_duration_in_hh ||
                                "dico_total_duration_in_hh"
                            }}</label>
                            <input
                              type="text"
                              class="form-control"
                              formControlName="totaleDurationBetweenTown"
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mt-3 w-50">
                    <div
                      class="card h-100"
                      style="background-color: #eff2f5; border-color: #bfc6c9"
                    >
                      <div class="card-body">
                        <div class="row p-3">
                          <div class="col-md-8">
                            <app-google-map></app-google-map>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="grid-container m-3">
              <div class="row">
                <div class="container">
                  <div class="row">
                    <app-total-loss-towing-table
                      [supplierGarageLov]="supplierGarageLov"
                      [notificationStatusCode]="
                        policyData.notificationStatusCode
                      "
                      [notificationId]="notificationId"
                      [lossCarId]="lossCarId"
                    ></app-total-loss-towing-table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </ng-container>
</form>
